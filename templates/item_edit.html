{% extends "base.html" %}
{% block content %}
  <div class="card rounded-2xl border border-slate-200 bg-white p-4 sm:p-6 shadow-sm">
    <h2 class="text-lg font-semibold text-slate-900">材料編集（ID: {{ item["item_id"] }}）</h2>

    <form method="post" action="{{ url_for('item_update', item_id=item['item_id']) }}">
      <label>材料名（必須）</label>
      <input name="name" value="{{ item['name'] }}" required>

      <label>単位（必須）</label>
      <select name="unit_base" required>
        {% set u = item['unit_base'] %}
        <option value="">選択してください</option>
        <option value="g"   {{ "selected" if u=="g" else "" }}>g</option>
        <option value="ml"  {{ "selected" if u=="ml" else "" }}>ml</option>
        <option value="pcs" {{ "selected" if u=="pcs" else "" }}>pcs（個）</option>
        <option value="kg"  {{ "selected" if u=="kg" else "" }}>kg</option>
      </select>

      <label>原価区分</label>
      <select name="cost_group">
        <option value="FOOD" {{ "selected" if item["cost_group"]=="FOOD" else "" }}>食材原価（38カウント）</option>
        <option value="SUPPLIES" {{ "selected" if item["cost_group"]=="SUPPLIES" else "" }}>消耗品</option>
      </select>

      <div class="row grid gap-4 sm:grid-cols-2">
        <div>
          <label>発注目安（reorder_point）</label>
          <input name="reorder_point" type="number" step="0.01" min="0"
                 value="{{ item['reorder_point'] }}">
        </div>
        <div>
          <label>参考価格（ref_unit_price）</label>
          <input name="ref_unit_price" type="number" step="0.01" min="0"
                 value="{{ '%.2f'|format(item['ref_unit_price'] or 0) }}">
        </div>
      </div>

      <label>メモ</label>
      <textarea name="note" rows="3">{{ item['note'] or '' }}</textarea>

      <label>仕入れ先（任意）</label>
      <select name="supplier_id">
        <option value="">未設定</option>
        {% for s in suppliers %}
          <option value="{{ s['supplier_id'] }}"
            {{ "selected" if item["supplier_id"] == s["supplier_id"] else "" }}>
            {{ s['name'] }}
          </option>
        {% endfor %}
      </select>

      <label>有効</label>
      <select name="is_active">
        <option value="1" {{ "selected" if item["is_active"] else "" }}>有効</option>
        <option value="0" {{ "selected" if not item["is_active"] else "" }}>無効</option>
      </select>

      <label>
        <input type="checkbox" name="is_fixed" value="1" {{ "checked" if item["is_fixed"] else "" }}>
        固定（本部指定の材料）
      </label>
      <div class="muted">別商品にすると「品質」が変わる可能性があるので、本部の使用材料で統一して下さい。</div>

      <div class="actions mt-4 flex flex-wrap items-center gap-2">
        <button class="btn inline-flex items-center justify-center rounded-xl bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400" type="submit">更新する</button>
        <a class="btn secondary inline-flex items-center justify-center rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm hover:bg-slate-50" href="{{ url_for('items_list') }}">戻る</a>
      </div>
    </form>
  </div>
{% endblock %}
